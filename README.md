# Trip & Co - Документация

## Оглавление

0. [Полезные ресурсы](#полезные-ресурсы)
1. [Описание проекта](#описание-проекта)
2. [Установка зависимостей](#установка-зависимостей)
    - [Frontend](#frontend)
    - [Backend](#backend)
3. [Запуск проекта](#запуск-проекта)
    - [Локальный запуск Frontend](#локальный-запуск-frontend)
    - [Локальный запуск Backend](#локальный-запуск-backend)
    - [Локальный запуск PostgreSQL](#локальный-запуск-postgresql)
4. [Структура проекта](#структура-проекта)
5. [Работа с API](#работа-с-api)
    - [Создание тестовых данных](#создание-тестовых-данных)
6. [База данных](#база-данных)
    - [Структура базы данных](#структура-базы-данных)
7. [Тестирование](#тестирование)
8. [Как внести изменения](#как-внести-изменения)

---

## Полезные ресурсы

- [Страница на cs-uni.ru](https://cs-uni.ru/index.php?title=DDF24_TripAndCo)
- [Презентация](https://docs.google.com/presentation/d/12k2GQclP49nOczdCk603PitXAQEPJRWr/edit?usp=sharing&ouid=114585532466377169577&rtpof=true&sd=true)
- [Видео](https://drive.google.com/file/d/1MiC1Blga2wrYgSxYojjgqtgl43jP0qfp/view?usp=sharing)

## Описание проекта

**Trip & Co** — это приложение для совместного планирования поездок, которое помогает группам пользователей
организовывать путешествия, выбирая маршруты, достопримечательности, транспорт и жилье. Платформа упрощает процесс
планирования, позволяя каждому участнику вносить предложения и голосовать за них, обсуждать детали поездки и принимать
коллективные решения.

---

## Установка зависимостей

### Frontend

Для установки зависимостей фронтенда выполните следующие шаги:

1. Перейдите в директорию фронтенда:

```bash
cd ./frontend
```

2. Установите зависимости:

```bash
   npm install
```

3. Запустите сервер:

```bash
npm run serve # По умолчанию приложение будет доступно на порту 8080
```

### Backend

Для установки зависимостей бэкенда выполните следующие шаги:

1. Создайте виртуальное окружение:

```bash
python3 -m venv venv
```

2. Активируйте виртуальное окружение:
    - Для macOS/Linux:
   ```bash
   source venv/bin/activate
   ```

    - Для Windows:
    ```bash
    venv\Scripts\activate
   ```


3. Установите зависимости:

   pip install -r requirements.txt

---

## Запуск проекта

### Локальный запуск Frontend

Frontend запускается с использованием команды `npm run serve`, которая по умолчанию поднимет сервер на порту 8080. Для
доступа откройте браузер и перейдите по адресу [http://localhost:8080](http://localhost:8080).

### Локальный запуск Backend

Для запуска Backend сервера выполните следующую команду:
```bash
uvicorn main:app --reload
````

Сервер будет доступен по адресу http://localhost:8000.

## Локальный запуск PostgreSQL
Для локального запуска PostgreSQL выполните скрипт:

```bash
./backend/postgres_run.sh
```

Чтобы подключиться к базе данных через psql:

```bash
docker exec -it postgres psql -U postgres -d hac_db
```
## Структура проекта
```

├── api_clients
│ └── aviasales_client.py # Клиент для работы с API Aviasales
├── app
│ ├── __init__.py # Инициализация приложения, коннекций, клиентов
│ ├── routes
│ │ └── *.py # Маршруты и хендлеры
│ └── services
│ └── *.py # Бизнес-логика приложения
├── db
│ ├── client.py # Интерфейс взаимодействия с базой данных
│ ├── data
│ │ ├── *.csv # Примерные данные (например, для тестирования)
│ ├── init.sql # Скрипт для инициализации базы данных
│ └── models.py # Модели базы данных
├── main.py # Основной файл для настройки и запуска приложения
└── postgres_run.sh # Скрипт для запуска локальной базы данных PostgreSQL

```

## Работа с API

### Создание тестовых данных

Для создания тестовых данных вы можете использовать следующие команды с помощью curl:

Создание поездки

```bash
curl -i http://0.0.0.0:8000/create_trip \
  -d '{"name": "test-trip", "origin_city_id": "MOW", "dest_city_id": "DXB", "created_by": "38171859-980f-438b-b220-be0e4bc9d631", "start_date": "2024-11-30", "end_date": "2024-12-25"}' \
  -X POST -H "Content-Type: application/json"
```

Создание элемента поездки (например, отель)

```bash
curl -i http://0.0.0.0:8000/create_view \
  -X POST -H "Content-Type: application/json" \
  -d '{"name": "test-trip-item", "trip_id": "1", "type": "hotel"}'
```

Создание голосования

```bash
curl -i http://0.0.0.0:8000/votes \
  -X POST -H "Content-Type: application/json" \
  -d '{"trip_item_id": "1", "user": "38171859-980f-438b-b220-be0e4bc9d631"}'
```

## База данных

### Структура базы данных

Структура базы данных для проекта представлена на [dbdiagram.io](https://dbdiagram.io/d/672b9adee9daa85aca8c62b7).